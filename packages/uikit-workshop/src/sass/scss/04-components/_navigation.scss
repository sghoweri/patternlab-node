/*------------------------------------*\
    #NAVIGATION
\*------------------------------------*/

/**
 * Navigation container
 * 1) Collapse height on small screens. Menu trigger button
 *    activates nav
 */

$nav-indentation: 1.5rem;

.pl-c-nav {
  background-color: inherit;
  
  @media all and (max-width: $pl-bp-med - 1) {
    position: absolute;
    top: 100%;
    width: 100%;
    overflow: hidden;
    max-height: 0; /* 1 */
    // background-color: $pl-color-black;
    display: flex;
    flex-direction: column;
    transition: max-height $pl-animate-quick ease-out;
    z-index: 10; // so search results don't overlap context menu on mobile

    /**
      * Active navigaiton
      * 1) Slide 
      * 2) Set the height to the vierport height minus the height
      *    of the header
      */
    &.pl-is-active {
      // @include hideScrollBar;
      max-height: 100vh;
      max-height: calc(var(--viewport-height));
      overflow: auto;
      box-shadow: 0 1px 2px 0 rgba($pl-color-gray-xdark, 0.5);
    }
  }

  @media all and (min-width: $pl-bp-med) {
    display: flex;

    .pl-c-body--theme-vertical &,
    .pl-c-body--theme-sidebar & {
      display: block;
      flex-direction: column;
      padding-top: 0;
      padding-left: 0.5rem;
      padding-right: 0.5rem;
      padding-bottom: 0.5rem;
      overflow: auto;
    }
  }
}

/**
 * Nav list
 * 1) appears as an <ol>
 * 2) display as a horizontal list on larger screens
 * 3) On small screens, move the nav list after the typeahead form field
 */
.pl-c-nav__list {
  z-index: 1;
  margin: 0;
  padding: 0;
  list-style: none;
  background-color: inherit;

  @media all and (max-width: $pl-bp-med - 1) {
    order: 2; /* 3 */
  }

  /**
  * Nav list
  * 1) Stack main categories on top of each other
  * 2) Put typeahead search above nav list
  */
  @media all and (min-width: $pl-bp-med) {
    display: flex;

    .pl-c-body--theme-vertical &,
    .pl-c-body--theme-sidebar & {
      flex-direction: column; /* 1 */
      order: 2; /* 2 */
    }
  }

  
}

/**
 * Nav list item
 */
.pl-c-nav__item {
  cursor: pointer;
  position: relative;
  background-color: inherit;
}

/**
 * Last sublist item
 */
.pl-c-nav__sublist > .pl-c-nav__item:last-child {
  @media all and (min-width: $pl-bp-med) {
    overflow: hidden;
    border-bottom-left-radius: $pl-border-radius-med;
    border-bottom-right-radius: $pl-border-radius-med;
  }
}

/**
 * Nav link
 */
.pl-c-nav__link {
  @include linkStyle;
  @include noSelect;
  display: flex;
  align-items: center;
  height: 100%;

  .pl-c-nav__sublist & {
    .pl-c-body--theme-vertical &,
    .pl-c-body--theme-sidebar & {
      @media all and (min-width: $pl-bp-med) {
        padding-left: $nav-indentation;
      }
    }
  }
}

/**
 * Nav sublink
 * 1) Visually differentiate sub-item links from
 *    the other links. Creates better hierarchy.
 */
.pl-c-nav__link--sublink {
  text-transform: none;
  padding-left: $nav-indentation;
}

/**
 * Nav link
 */
.pl-c-nav__link--dropdown {
  /**
    * Dropdown caret after accordion handle
    */
  &:before {
    content: '\25e5';
    color: currentColor;
    display: inline-block;
    font-size: 6px;
    position: relative;
    top: 0;
    right: 0;
    transition: transform $pl-animate-quick ease-out, opacity $pl-animate-quick ease-out;
    transform: rotate(45deg);
    opacity: 0.6;
    margin-right: 0.5rem;
    // padding: 6px;
    line-height: 1;
    // .pl-c-body--theme-light & {
    //   color: $pl-color-gray;
    // }
  }

  &:hover,
  &:focus {
    &:after {
      opacity: 0.8;
      // color: $pl-color-gray-dark;
    }
  }

  /**
     * Active dropdown
     */
  &.pl-is-active {
    // color: $pl-color-white;
    // background-color: rgba($pl-color-white, 0.1);

    /**
      * Caret rotation and positioning in active dropdown
      */
    &:before {
      opacity: 1;
      // color: $pl-color-white;
      transform: rotate(90deg);
    }
  }


  .pl-c-body--theme-light & { 
    color: $pl-color-gray-xdark;
    background-color: $pl-color-white;
  }
}

/**
 * Nav sublist
 * 1) On larger screens, display as dropdowns that
 *    hang over the header
 */
.pl-c-nav__sublist {
  @include listReset;

  .pl-c-body--theme-light & {
    background-color: $pl-color-white;
  }

  .pl-c-body--theme-vertical &,
  .pl-c-body--theme-sidebar & {
    @media all and (min-width: $pl-bp-med) {
      position: relative;
      border-radius: 0;
    }
  }

  @media all and (min-width: $pl-bp-med) {
    position: absolute;
    top: auto;
    left: 0;
    min-width: 10rem;
    overflow: hidden;
    border-bottom-left-radius: $pl-border-radius-med;
    border-bottom-right-radius: $pl-border-radius-med;
  }

  &--dropdown {
    box-shadow: 0 1px 2px 0 rgba($pl-color-gray-xdark, 0.5);

    @media all and (min-width: $pl-bp-med) {
      .pl-c-body--theme-vertical & {
        box-shadow: none;
      }
    }
  }
}

/**
 * Dropdown sublist
 */
.pl-c-nav__sublist--dropdown,
.pl-c-nav__subsublist--dropdown {
  @include listReset;
  @include accordionPanel;
  background-color: inherit;
  // background-color: $pl-color-black;

  .pl-c-body--theme-vertical &,
  .pl-c-body--theme-sidebar & {
    @media all and (min-width: $pl-bp-med) {
      border: 0;
      // border-left: 1px solid $pl-color-gray-xdark;
    }
  }

  &.pl-is-active {
    .pl-c-body--theme-vertical &,
    .pl-c-body--theme-sidebar & {
      @media all and (min-width: $pl-bp-med) {
        max-height: none;
      }
    }
  }

  .pl-c-body--theme-light.pl-c-body--theme-vertical &,
  .pl-c-body--theme-light.pl-c-body--theme-sidebar & {
    @media all and (min-width: $pl-bp-med) {
      // border-left-color: $pl-color-gray-light;
    }
  }
}


.pl-c-nav__subsublist {
  .pl-c-body--theme-vertical &,
  .pl-c-body--theme-sidebar & {
    @media all and (min-width: $pl-bp-med) {
      // border-left: 1px solid $pl-color-gray-xdark;
      margin-left: $nav-indentation;
    }
  }
}